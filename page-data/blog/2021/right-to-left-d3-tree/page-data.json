{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2021/right-to-left-d3-tree/","result":{"data":{"site":{"siteMetadata":{"title":"Roman Klimenko"}},"markdownRemark":{"id":"c3c16d55-6ad6-5538-aeaa-4ddc189563a1","excerpt":"Recently I needed to render a right-to-left D3.js tree to visualize the mapping of multiple entities into one (as opposed to branching of one entity into manyâ€¦","html":"<img src=\"left-to-rigth-tree.png\" style=\"max-height: 450px;\" class=\"img-fluid\" />\n<p>Recently I needed to render a right-to-left D3.js tree to visualize the mapping of multiple entities into one (as opposed to branching of one entity into many).\nThe right way to do it is to tweak the <a href=\"https://github.com/d3/d3-shape#linkHorizontal\"><code class=\"language-text\">d3.linkHorizontal()</code></a> so instead of:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> link <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">linkHorizontal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>it could be like:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> link <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">linkHorizontal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> width <span class=\"token operator\">-</span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>But that's not all that you have to do. The Internet is full of unanswered StackOverflow questions and <a href=\"https://bl.ocks.org/mbostock/3184089\">obsolete examples</a>. My approach is probably not the best one, but it works for me: I let D3.js to render a normal left-to-right tree, then flip it horizontally via <code class=\"language-text\">transform</code>, flip all the texts back with another <code class=\"language-text\">transform</code>, and finally invert the text anchors, so the labels are where they have to be:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  svg<span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"transform\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"scale(-1, 1)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  svg\n    <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"transform\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"scale(-1, 1)\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text-anchor\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"start\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text-anchor\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"start\"</span> <span class=\"token operator\">?</span> <span class=\"token number\">6</span> <span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Here is the result:</p>\n<img src=\"right-to-left-tree.png\" style=\"max-height: 450px;\" class=\"img-fluid\" />\n<p><a href=\"https://observablehq.com/@romaklimenko/right-to-left-tidy-tree\">https://observablehq.com/@romaklimenko/right-to-left-tidy-tree</a></p>","fields":{"slug":"/blog/2021/right-to-left-d3-tree/"},"frontmatter":{"title":"Render a right-to-left tree with D3.js","date":"April 30, 2021","tags":["how-to","d3js","dataisbeautiful"],"description":null}},"previous":{"fields":{"slug":"/blog/2021/list-locations/"},"frontmatter":{"title":"List Azure resource locations"}},"next":null},"pageContext":{"id":"c3c16d55-6ad6-5538-aeaa-4ddc189563a1","previousPostId":"7e73219f-8b96-5671-84ac-d5a84f011abf","nextPostId":null}},"staticQueryHashes":["2841359383"]}